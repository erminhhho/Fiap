<form id="social-form" autocomplete="off">
  <!-- Card do Perfil Social -->
  <div class="bg-white rounded-2xl shadow p-8 mb-8">
    <div class="mb-8">      <!-- Título alinhado com a mesma estrutura da página pessoal -->
      <div class="flex items-center mb-4">
        <div class="flex items-center gap-2 flex-grow">
          <i class="fas fa-users text-blue-500 text-2xl"></i>
          <h2 class="text-lg font-semibold text-blue-600">Composição Familiar</h2>
        </div>
      </div>

      <!-- Container para os membros da família -->
      <div id="membros-familia-container">
        <!-- Lista de membros da família -->
        <div id="membros-familia-list" class="space-y-6">
          <!-- O assistido será adicionado aqui automaticamente via JS -->
        </div>
      </div>

      <!-- Template para o assistido (primeira linha fixa) -->
      <template id="assistido-template">
        <div class="membro-familia mb-6 relative assistido">
          <div class="grid grid-cols-1 md:grid-cols-24 gap-4">
            <!-- Nome do assistido - 6 colunas (preenchido automaticamente) -->
            <div class="relative md:col-span-6">
              <input type="text" name="familiar_nome[]" id="assistido_nome" class="peer w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-3 text-gray-800 placeholder-gray-400 transition-colors duration-200" readonly />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Nome do Assistido
              </label>
            </div>

            <!-- CPF - 3 colunas (preenchido automaticamente) - reduzido -->
            <div class="relative md:col-span-3">
              <input type="text" name="familiar_cpf[]" id="assistido_cpf" class="peer w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-3 text-gray-800 placeholder-gray-400 transition-colors duration-200" readonly />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                CPF
              </label>
            </div>

            <!-- Idade - 2 colunas (preenchido automaticamente) -->
            <div class="relative md:col-span-2">
              <input type="text" name="familiar_idade[]" id="assistido_idade" class="peer w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-3 text-gray-800 placeholder-gray-400 transition-colors duration-200" readonly />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Idade
              </label>
            </div>

            <!-- Parentesco - 4 colunas (fixo como "Assistido") -->
            <div class="relative md:col-span-4">
              <input type="text" name="familiar_parentesco[]" value="Assistido" class="peer w-full rounded-lg border border-gray-300 bg-gray-100 px-4 py-3 text-gray-800 transition-colors duration-200" readonly />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Parentesco
              </label>
            </div>

            <!-- Estado Civil - 4 colunas (pode ser editado) -->
            <div class="relative md:col-span-4">
              <select name="familiar_estado_civil[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 transition-colors duration-200">
                <option value="" selected disabled>Selecione...</option>
                <option value="Solteiro(a)">Solteiro(a)</option>
                <option value="Casado(a)">Casado(a)</option>
                <option value="União Estável">União Estável</option>
                <option value="Divorciado(a)">Divorciado(a)</option>
                <option value="Viúvo(a)">Viúvo(a)</option>
              </select>
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Estado Civil
              </label>
            </div>            <!-- Renda Mensal - 2 colunas (pode ser editado) -->
            <div class="relative md:col-span-2">
              <input type="text" name="familiar_renda[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200" placeholder="R$ 0" oninput="if(FIAP.masks && typeof FIAP.masks.money === 'function') FIAP.masks.money(this)" />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Renda
              </label>
            </div><!-- CadÚnico - 2 colunas -->
            <div class="relative md:col-span-2 flex items-center justify-center">
              <input type="hidden" name="familiar_cadunico[]" value="Não">
              <button type="button" class="cadunico-btn rounded-lg border border-gray-300 text-gray-500 hover:border-blue-500 hover:text-blue-600" title="Possui CadÚnico?" onclick="toggleCadUnico(this)">
                CadÚnico
              </button>
            </div>            <!-- Botão de adicionar membro ao lado do assistido -->
            <div class="relative md:col-span-1 flex items-center justify-center">
              <button type="button" class="add-family-btn bg-blue-500 hover:bg-blue-600 text-white rounded-full p-1 flex items-center justify-center w-8 h-8" title="Adicionar membro" onclick="addFamilyMember()">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>
        </div>
      </template>

      <!-- Template para membro da família (oculto) -->
      <template id="membro-familia-template">
        <div class="membro-familia mb-6 relative">
          <div class="grid grid-cols-1 md:grid-cols-24 gap-4">
            <!-- Nome do membro - 6 colunas -->
            <div class="relative md:col-span-6">
              <input type="text" name="familiar_nome[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200" placeholder="Nome completo" />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Nome completo
              </label>
            </div>

            <!-- CPF - 3 colunas (reduzido) -->
            <div class="relative md:col-span-3">
              <input type="text" name="familiar_cpf[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200" placeholder="000.000.000-00" oninput="maskCPF(this)" />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                CPF
              </label>
            </div>

            <!-- Idade - 2 colunas -->
            <div class="relative md:col-span-2">
              <input type="text" name="familiar_idade[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200" placeholder="Idade" />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Idade
              </label>
            </div>

            <!-- Parentesco - 4 colunas -->
            <div class="relative md:col-span-4">
              <select name="familiar_parentesco[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 transition-colors duration-200">
                <option value="" selected disabled>Selecione...</option>
                <option value="Cônjuge">Cônjuge</option>
                <option value="Filho(a)">Filho(a)</option>
                <option value="Pai/Mãe">Pai/Mãe</option>
                <option value="Irmão/Irmã">Irmão/Irmã</option>
                <option value="Outro">Outro</option>
              </select>
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Parentesco
              </label>
            </div>

            <!-- Estado Civil - 4 colunas -->
            <div class="relative md:col-span-4">
              <select name="familiar_estado_civil[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 transition-colors duration-200">
                <option value="" selected disabled>Selecione...</option>
                <option value="Solteiro(a)">Solteiro(a)</option>
                <option value="Casado(a)">Casado(a)</option>
                <option value="União Estável">União Estável</option>
                <option value="Divorciado(a)">Divorciado(a)</option>
                <option value="Viúvo(a)">Viúvo(a)</option>
              </select>
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Estado Civil
              </label>
            </div>            <!-- Renda Mensal - 2 colunas -->
            <div class="relative md:col-span-2">
              <input type="text" name="familiar_renda[]" class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200" placeholder="R$ 0" oninput="if(FIAP.masks && typeof FIAP.masks.money === 'function') FIAP.masks.money(this)" />
              <label class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none">
                Renda
              </label>
            </div>

            <!-- CadÚnico - 2 colunas -->
            <div class="relative md:col-span-2 flex items-center justify-center">
              <input type="hidden" name="familiar_cadunico[]" value="Não">
              <button type="button" class="cadunico-btn rounded-lg border border-gray-300 text-gray-500 hover:border-blue-500 hover:text-blue-600" title="Possui CadÚnico?" onclick="toggleCadUnico(this)">
                CadÚnico
              </button>
            </div>

            <!-- Botão de remover (somente nas linhas secundárias) - 1 coluna -->
            <div class="relative md:col-span-1 flex items-center justify-center">
              <button type="button" class="remove-familiar-btn bg-red-500 hover:bg-red-600 text-white rounded-full p-1 ml-2 flex items-center justify-center w-8 h-8" title="Remover membro" onclick="removeSpecificFamilyMember(this)">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
        </div>
      </template>    </div>

    <!-- Seção de Renda Familiar -->
    <div class="mt-8 border-t pt-6 border-gray-200">
      <div class="flex items-center mb-4 justify-between">
        <div class="flex items-center gap-2">
          <i class="fas fa-money-bill-wave text-blue-500 text-2xl"></i>
          <h2 class="text-lg font-semibold text-blue-600">Análise de Renda Familiar (CadÚnico)</h2>
        </div>
        <div class="flex items-center gap-4">
          <div class="text-sm font-medium">
            <span class="text-gray-600">Renda Total:</span>
            <span id="renda_total_display" class="text-blue-700 ml-1">R$ 0,00</span>
          </div>
          <div class="text-sm font-medium">
            <span class="text-gray-600">Renda Per Capita:</span>
            <span id="renda_per_capita_display" class="text-blue-700 ml-1">R$ 0,00</span>
          </div>
        </div>
      </div>

      <!-- Campos ocultos para armazenar valores -->
      <input type="hidden" id="renda_total_familiar" name="renda_total_familiar" value="0" />
      <input type="hidden" id="renda_per_capita" name="renda_per_capita" value="0" />      <!-- Termômetro de Renda Per Capita em Relação ao Salário Mínimo (Melhorado) -->
      <div class="bg-gray-100 p-4 rounded-lg mt-4 shadow-inner">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-gray-700 font-medium">Análise de Renda Per Capita</h3>
          <span class="text-sm text-gray-600">Relação com o Salário Mínimo (<span id="salario-minimo-display">R$ 1.502,00</span>)</span>
        </div>

        <!-- Gráfico melhorado -->
        <div class="relative pt-5 pb-8">
          <!-- Barra de fundo com gradiente suave -->
          <div class="h-4 bg-gray-200 rounded-lg shadow-inner relative">
            <!-- Marcadores de salário mínimo com valores mais detalhados -->
            <div class="absolute -bottom-7 left-0 transform -translate-x-1/2">
              <div class="h-5 w-1 bg-gray-500 mb-1 mx-auto"></div>
              <span class="text-xs font-medium text-gray-600 whitespace-nowrap">R$ 0</span>
            </div>
            <div class="absolute -bottom-7 left-1/4 transform -translate-x-1/2">
              <div class="h-5 w-1 bg-gray-500 mb-1 mx-auto"></div>
              <span class="text-xs font-medium text-gray-600 whitespace-nowrap">1/4 SM</span>
            </div>
            <div class="absolute -bottom-7 left-1/2 transform -translate-x-1/2">
              <div class="h-5 w-1 bg-gray-500 mb-1 mx-auto"></div>
              <span class="text-xs font-medium text-gray-600 whitespace-nowrap">1/2 SM</span>
            </div>
            <div class="absolute -bottom-7 left-3/4 transform -translate-x-1/2">
              <div class="h-5 w-1 bg-gray-500 mb-1 mx-auto"></div>
              <span class="text-xs font-medium text-gray-600 whitespace-nowrap">3/4 SM</span>
            </div>
            <div class="absolute -bottom-7 right-0 transform translate-x-1/2">
              <div class="h-5 w-1 bg-gray-500 mb-1 mx-auto"></div>
              <span class="text-xs font-medium text-gray-600 whitespace-nowrap">1 SM</span>
            </div>

            <!-- Indicador de valor atual com design melhorado -->
            <div id="renda-indicator" class="absolute top-0 -mt-6 transform -translate-x-1/2" style="left: 0%">
              <div class="w-4 h-4 bg-blue-600 rounded-full shadow-md mx-auto mb-1"></div>
              <span class="text-xs font-medium bg-blue-100 text-blue-800 px-2 py-1 rounded shadow-sm whitespace-nowrap">
                R$ 0,00
              </span>
            </div>

            <!-- Barra de progresso colorida com gradiente mais suave -->
            <div id="renda-progress" class="h-4 bg-gradient-to-r from-red-500 via-yellow-400 to-green-500 rounded-lg shadow-sm" style="width: 0%"></div>
          </div>
        </div>        <!-- Legenda compacta com valores de referência -->
        <div class="flex justify-between text-xs mt-6">
          <div class="flex items-center px-2 py-1 bg-red-100 rounded-md">
            <div class="w-2 h-2 bg-red-500 mr-1 rounded-full"></div>
            <span class="text-red-700">Extrema Pobreza</span>
          </div>
          <div class="flex items-center px-2 py-1 bg-yellow-100 rounded-md">
            <div class="w-2 h-2 bg-yellow-500 mr-1 rounded-full"></div>
            <span class="text-yellow-700">Pobreza</span>
          </div>
          <div class="flex items-center px-2 py-1 bg-green-100 rounded-md">
            <div class="w-2 h-2 bg-green-500 mr-1 rounded-full"></div>
            <span class="text-green-700">Acima da Linha de Pobreza</span>
          </div>
        </div>
      </div><!-- Observações sobre a situação social -->
      <div class="relative mt-6 pt-4 border-t border-gray-200">
        <div class="relative">
          <textarea id="obs_sociais" name="obs_sociais" rows="3"
            class="peer w-full rounded-lg border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 px-4 py-3 text-gray-800 bg-gray-50 placeholder-gray-400 transition-colors duration-200"
            placeholder="Observações relevantes sobre a situação socioeconômica do assistido e sua família..."></textarea>
          <label for="obs_sociais"
            class="absolute left-4 -top-3 px-1 text-sm text-blue-600 bg-gray-50 rounded-t-lg rounded-b-none transition-all duration-200 pointer-events-none">
            Observações
          </label>
        </div>
      </div>
    </div>
  </div>

  <div class="flex justify-between mt-8">
    <button type="button" class="bg-gray-100 hover:bg-gray-200 text-blue-600 font-semibold rounded-lg px-8 py-3 text-base shadow border border-blue-200 transition focus:outline-none focus:ring-2 focus:ring-blue-100 flex items-center gap-2" id="btn-back">
      <i class="fas fa-arrow-left"></i> Anterior
    </button>
    <button type="button" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg px-8 py-3 text-base shadow transition focus:outline-none focus:ring-2 focus:ring-blue-300 flex items-center gap-2" id="btn-next">
      Próximo <i class="fas fa-arrow-right"></i>
    </button>
  </div>
</form>
<!-- Nota: js/social.js não é mais necessário, pois o módulo é carregado automaticamente pelo router -->
